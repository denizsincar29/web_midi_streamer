# Apache Proxy Configuration for Web MIDI Streamer
# Add these lines to your Apache virtual host configuration

# For HTTP (port 80) or HTTPS (port 443) virtual host

# Enable required modules first:
# sudo a2enmod proxy proxy_http proxy_wstunnel rewrite

# Example 1: Proxy at root path /
# WebSocket proxy for signaling
ProxyPass /ws/ ws://localhost:8000/ws/
ProxyPassReverse /ws/ ws://localhost:8000/ws/

# HTTP proxy for static files and API
ProxyPass / http://localhost:8000/
ProxyPassReverse / http://localhost:8000/

# Example 2: Proxy under subdirectory /midi/
# WebSocket proxy for signaling
ProxyPass /midi/ws/ ws://localhost:8000/ws/
ProxyPassReverse /midi/ws/ ws://localhost:8000/ws/

# HTTP proxy for static files and API
ProxyPass /midi/ http://localhost:8000/
ProxyPassReverse /midi/ http://localhost:8000/

# Alternative configuration with <Location> blocks:
# 
# For root path:
# <Location /ws/>
#     ProxyPass ws://localhost:8000/ws/
#     ProxyPassReverse ws://localhost:8000/ws/
# </Location>
# 
# <Location />
#     ProxyPass http://localhost:8000/
#     ProxyPassReverse http://localhost:8000/
# </Location>
#
# For /midi/ subdirectory:
# <Location /midi/ws/>
#     ProxyPass ws://localhost:8000/ws/
#     ProxyPassReverse ws://localhost:8000/ws/
# </Location>
# 
# <Location /midi/>
#     ProxyPass http://localhost:8000/
#     ProxyPassReverse http://localhost:8000/
# </Location>

# For HTTPS, also add:
# RequestHeader set X-Forwarded-Proto "https"
# RequestHeader set X-Forwarded-Port "443"

# NOTE: The Web MIDI Streamer automatically detects the base path
# from the URL, so it will work with any proxy path configuration.
# Just make sure the WebSocket proxy path matches: <base_path>/ws/
